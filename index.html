<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>–ü–æ–¥–±–æ—Ä–∫–∞ –æ—Ç –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    .container {
      max-width: 500px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    h2 {
      font-size: 22px;
      font-weight: 600;
      color: #0057b8;
      margin: 0 0 24px;
      text-align: center;
    }
    .step { display: none; }
    .step.active { display: block; }
    input, select, button {
      width: 100%;
      padding: 14px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
      box-sizing: border-box;
    }
    button {
      background: #0057b8;
      color: white;
      border: none;
      font-weight: 600;
      cursor: pointer;
      margin-top: 20px;
    }
    button:hover { background: #004694; }
    .progress {
      display: flex;
      justify-content: space-between;
      margin-bottom: 24px;
      position: relative;
    }
    .progress::before {
      content: '';
      position: absolute;
      top: 8px;
      left: 0;
      right: 0;
      height: 2px;
      background: #e0e0e0;
      z-index: 1;
    }
    .dot {
      width: 16px;
      height: 16px;
      background: #e0e0e0;
      border-radius: 50%;
      position: relative;
      z-index: 2;
    }
    .dot.active { background: #0057b8; }
  </style>
</head>
<body>
  <div class="container">
    <div class="progress">
      <div class="dot active" id="dot1"></div>
      <div class="dot" id="dot2"></div>
      <div class="dot" id="dot3"></div>
      <div class="dot" id="dot4"></div>
    </div>

    <div class="step active" id="step1">
      <h2>–®–∞–≥ 1 –∏–∑ 4</h2>
      <input type="text" id="budget" placeholder="–í–∞—à –±—é–¥–∂–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ 15 –º–ª–Ω ‚ÇΩ)">
      <button onclick="nextStep(1)">–î–∞–ª–µ–µ</button>
    </div>

    <div class="step" id="step2">
      <h2>–®–∞–≥ 2 –∏–∑ 4</h2>
      <select id="district">
        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–π–æ–Ω</option>
        <option value="–¶–µ–Ω—Ç—Ä">–¶–µ–Ω—Ç—Ä</option>
        <option value="–•–∞–º–æ–≤–Ω–∏–∫–∏">–•–∞–º–æ–≤–Ω–∏–∫–∏</option>
        <option value="–ë–µ–≥–æ–≤–æ–π">–ë–µ–≥–æ–≤–æ–π</option>
        <option value="–ù–æ–≤–æ-–ü–µ—Ä–µ–¥–µ–ª–∫–∏–Ω–æ">–ù–æ–≤–æ-–ü–µ—Ä–µ–¥–µ–ª–∫–∏–Ω–æ</option>
        <option value="–î—Ä—É–≥–æ–π">–î—Ä—É–≥–æ–π</option>
      </select>
      <button onclick="prevStep(2)">–ù–∞–∑–∞–¥</button>
      <button onclick="nextStep(2)" style="margin-top: 10px;">–î–∞–ª–µ–µ</button>
    </div>

    <div class="step" id="step3">
      <h2>–®–∞–≥ 3 –∏–∑ 4</h2>
      <select id="rooms">
        <option value="">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç</option>
        <option value="1">1-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
        <option value="2">2-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
        <option value="3">3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
        <option value="4+">4+ –∫–æ–º–Ω–∞—Ç</option>
        <option value="–°—Ç—É–¥–∏—è">–°—Ç—É–¥–∏—è</option>
      </select>
      <button onclick="prevStep(3)">–ù–∞–∑–∞–¥</button>
      <button onclick="nextStep(3)" style="margin-top: 10px;">–î–∞–ª–µ–µ</button>
    </div>

    <div class="step" id="step4">
      <h2>–®–∞–≥ 4 –∏–∑ 4</h2>
      <input type="text" id="name" placeholder="–í–∞—à–µ –∏–º—è">
      <input type="tel" id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
      <button onclick="prevStep(4)">–ù–∞–∑–∞–¥</button>
      <button onclick="submitForm()" style="margin-top: 10px;">–ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–±–æ—Ä–∫—É</button>
    </div>
  </div>

  <script>
    let formData = {};

    function updateDots(currentStep) {
      for (let i = 1; i <= 4; i++) {
        document.getElementById(`dot${i}`).classList.toggle('active', i <= currentStep);
      }
    }

    function showStep(step) {
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      document.getElementById(`step${step}`).classList.add('active');
      updateDots(step);
    }

    function nextStep(currentStep) {
      const stepId = `step${currentStep}`;
      const inputs = document.getElementById(stepId).querySelectorAll('input, select');
      let valid = true;

      inputs.forEach(input => {
        if (!input.value.trim() && input.hasAttribute('required')) {
          valid = false;
        }
      });

      // –î–ª—è —à–∞–≥–∞ 1: –±—é–¥–∂–µ—Ç –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ –∂–µ–ª–∞—Ç–µ–ª–µ–Ω
      if (currentStep === 1) {
        formData.budget = document.getElementById('budget').value || '–ù–µ —É–∫–∞–∑–∞–Ω';
        showStep(2);
        return;
      }

      // –®–∞–≥ 2: —Ä–∞–π–æ–Ω
      if (currentStep === 2) {
        const district = document.getElementById('district').value;
        if (!district) {
          Telegram.WebApp.showAlert('–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–π–æ–Ω');
          return;
        }
        formData.district = district;
        showStep(3);
        return;
      }

      // –®–∞–≥ 3: –∫–æ–º–Ω–∞—Ç—ã
      if (currentStep === 3) {
        const rooms = document.getElementById('rooms').value;
        if (!rooms) {
          Telegram.WebApp.showAlert('–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç');
          return;
        }
        formData.rooms = rooms;
        showStep(4);
        return;
      }
    }

    function prevStep(currentStep) {
      showStep(currentStep - 1);
    }

    function submitForm() {
      const name = document.getElementById('name').value.trim();
      const phone = document.getElementById('phone').value.trim();

      if (!name || !phone) {
        Telegram.WebApp.showAlert('–£–∫–∞–∂–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω');
        return;
      }

      formData.name = name;
      formData.phone = phone;

      const message = 
        `üîî –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞\n` +
        `–ò–º—è: ${formData.name}\n` +
        `–¢–µ–ª–µ—Ñ–æ–Ω: ${formData.phone}\n` +
        `–ë—é–¥–∂–µ—Ç: ${formData.budget}\n` +
        `–†–∞–π–æ–Ω: ${formData.district}\n` +
        `–ö–æ–º–Ω–∞—Ç: ${formData.rooms}`;

      // === –ó–ê–ú–ï–ù–ò –ù–ê –°–í–û–ò –î–ê–ù–ù–´–ï ===
      const botToken = '8586234781:AAE87Am-arpkyk4tMcN44SYqSMJ8XDYrJKo';   // —Ç–æ–∫–µ–Ω —Ç–≤–æ–µ–≥–æ –±–æ—Ç–∞
      const chatId = '896319728';       // —Ç–≤–æ–π Telegram ID
      // =============================

      const url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}&parse_mode=HTML`;

      fetch(url)
        .then(() => {
          Telegram.WebApp.showAlert('–°–ø–∞—Å–∏–±–æ! –ü–æ–¥–±–æ—Ä–∫—É –æ—Ç–ø—Ä–∞–≤–∏–º –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.');
          setTimeout(() => Telegram.WebApp.close(), 2000);
        })
        .catch(() => {
          Telegram.WebApp.showAlert('–û—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
        });
    }

    // –ù–∞—á–∏–Ω–∞–µ–º —Å —à–∞–≥–∞ 1
    showStep(1);
  </script>
</body>
</html>
